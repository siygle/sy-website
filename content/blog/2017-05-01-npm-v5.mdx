---
title: '即將開始測試的 npm@5'
date: '2017-05-01'
tags: ['Node.js', 'npm', '2017']
draft: false
summary: '5/4 將會是第一個 npm@5 beta 釋出的時間，也終於將重心擺在執行效能與 shrinkwrap 改善之上'
layout: PostSimple
---

所以說競爭對使用者還是好事，自從 yarn 面世之後 npm 升版速度之快啊 XD

<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<blockquote class="twitter-tweet" data-cards="hidden" data-lang="en">
  <p lang="en" dir="ltr">
    Oh hey, a reminder that <a href="https://twitter.com/hashtag/npm5?src=hash">#npm5</a> is going
    into public beta this Thursday. There&#39;s a ton of really cool changes:{' '}
    <a href="https://t.co/Uzv7sOJX4a">https://t.co/Uzv7sOJX4a</a>{' '}
    <a href="https://twitter.com/npmjs">@npmjs</a>
  </p>
  &mdash; ✨ Kat! ✨ (@maybekatz){' '}
  <a href="https://twitter.com/maybekatz/status/859193556052750336">May 1, 2017</a>
</blockquote>

[5/4](https://github.com/npm/npm/pull/16244) 將會是第一個 npm@5 beta 釋出的時間，也終於將重心擺在執行效能與 shrinkwrap 改善之上。如果稍微看一下 v5 的 PR 所列出的更新，應該不難發現引用了不少 yarn 的行為 ;)

> [導入新的 `package-lock.json`](https://github.com/npm/npm/pull/16441/commits/7646f5f078963f67320cab13078168a686b718be?diff=unified&short_path=9195b56#diff-9195b56603665ac66a71ed45d6e026bd)  
> npm install -s 將成為預設的行為  
> [Refactor cache code](https://github.com/npm/npm/pull/15666)  
> 安全性改善

### package-lock.json

這應該是新版最特別的改變之一，[Spec 還在討論當中](https://github.com/npm/npm/pull/16441)，所以伴隨著 beta 在測試可能還會有調整。

在 npm@5 之中，如果沒有存在 `npm-shrinkwrap.json` 就會預設產生 `package-lock.json`，但是該文件不會跟著 `npm publish` 一起出去，它的用途與格式基本上與 `npm-shrinkwrap.json` 一樣，除非下了 `npm shrinkwrap`，就會把 `package-lock.json` 轉成 `npm-shrinkwrap.json`。

配合上面提到的 [Refactor cache code](https://github.com/npm/npm/pull/15666) 預測應該速度會貼近 yarn（可能再看後續的調整，看 [benchmark](https://github.com/npm/npm/pull/16244#issuecomment-297190219) 還是有點落差 XD ）
